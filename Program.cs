using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;
using RT.Util;
using RT.Util.Consoles;
using RT.Util.ExtensionMethods;

namespace BfFastRoman
{
    class Program
    {
        static void Main(string[] args)
        {
            Ut.Tic();
            var rawcode = @"      A mandelbrot set fractal viewer in brainf*** written by Erik Bosman
+++++++++++++[->++>>>+++++>++>+<<<<<<]>>>>>++++++>--->>>>>>>>>>+++++++++++++++[[
>>>>>>>>>]+[<<<<<<<<<]>>>>>>>>>-]+[>>>>>>>>[-]>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>[-]+
<<<<<<<+++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>>>>+>>>>>>>>>>>>>>>>>>>>>>>>>>
>+<<<<<<<<<<<<<<<<<[<<<<<<<<<]>>>[-]+[>>>>>>[>>>>>>>[-]>>]<<<<<<<<<[<<<<<<<<<]>>
>>>>>[-]+<<<<<<++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>>>+<<<<<<+++++++[-[->>>
>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>>>+<<<<<<<<<<<<<<<<[<<<<<<<<<]>>>[[-]>>>>>>[>>>>>
>>[-<<<<<<+>>>>>>]<<<<<<[->>>>>>+<<+<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>
[>>>>>>>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+<<+<<<+<<]>>>>>>>>]<<<<<<<<<[<<<<<<<
<<]>>>>>>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+<<+<<<<<]>>>>>>>>>+++++++++++++++[[
>>>>>>>>>]+>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+[
>+>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>[-<<<<+>>>>]<<<<[->>>>+<<<<<[->>[
-<<+>>]<<[->>+>>+<<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>>>>]<<<<<<<
<<[>[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<]>[->>>>>>>>>+<<<<<<<<<]<+>>>>>>>>]<<<<<<<<<
[>[-]<->>>>[-<<<<+>[<->-<<<<<<+>>>>>>]<[->+<]>>>>]<<<[->>>+<<<]<+<<<<<<<<<]>>>>>
>>>>[>+>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>>[-<<<<<+>>>>>]<<<<<[->>>>>+
<<<<<<[->>>[-<<<+>>>]<<<[->>>+>+<<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>
>>>>>>>]<<<<<<<<<[>>[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<<]>>[->>>>>>>>>+<<<<<<<<<]<<
+>>>>>>>>]<<<<<<<<<[>[-]<->>>>[-<<<<+>[<->-<<<<<<+>>>>>>]<[->+<]>>>>]<<<[->>>+<<
<]<+<<<<<<<<<]>>>>>>>>>[>>>>[-<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<+>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>]>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>+++++++++++++++[[>>>>
>>>>>]<<<<<<<<<-<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+>>>>>>>>>>>>>>>>>>>>>+<<<[<<<<<<
<<<]>>>>>>>>>[>>>[-<<<->>>]+<<<[->>>->[-<<<<+>>>>]<<<<[->>>>+<<<<<<<<<<<<<[<<<<<
<<<<]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>>>[-<<<<->>>>]+<<<<[->>>>-<[-<<<+>>>]<<<[->
>>+<<<<<<<<<<<<[<<<<<<<<<]>>>[-]+>>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>>>>>>>>]<<<<<<
<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]<<<<<<<[->+>>>-<<<<]>>>>>>>>>+++++++++++++++++++
+++++++>>[-<<<<+>>>>]<<<<[->>>>+<<[-]<<]>>[<<<<<<<+<[-<+>>>>+<<[-]]>[-<<[->+>>>-
<<<<]>>>]>>>>>>>>>>>>>[>>[-]>[-]>[-]>>>>>]<<<<<<<<<[<<<<<<<<<]>>>[-]>>>>>>[>>>>>
[-<<<<+>>>>]<<<<[->>>>+<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>[-<<<<<<<<
<+>>>>>>>>>]>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>+++++++++++++++[[>>>>>>>>>]+>[-
]>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+[>+>>>>>>>>]<<<
<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>>[-<<<<<+>>>>>]<<<<<[->>>>>+<<<<<<[->>[-<<+>>]<
<[->>+>+<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>>>>]<<<<<<<<<[>[->>>>
>>>>>+<<<<<<<<<]<<<<<<<<<<]>[->>>>>>>>>+<<<<<<<<<]<+>>>>>>>>]<<<<<<<<<[>[-]<->>>
[-<<<+>[<->-<<<<<<<+>>>>>>>]<[->+<]>>>]<<[->>+<<]<+<<<<<<<<<]>>>>>>>>>[>>>>>>[-<
<<<<+>>>>>]<<<<<[->>>>>+<<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>+>>>>>>>>
]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>>[-<<<<<+>>>>>]<<<<<[->>>>>+<<<<<<[->>[-<<+
>>]<<[->>+>>+<<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>>>>]<<<<<<<<<[>
[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<]>[->>>>>>>>>+<<<<<<<<<]<+>>>>>>>>]<<<<<<<<<[>[-
]<->>>>[-<<<<+>[<->-<<<<<<+>>>>>>]<[->+<]>>>>]<<<[->>>+<<<]<+<<<<<<<<<]>>>>>>>>>
[>>>>[-<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<+>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
]>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>[-<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<+>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>]>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>++++++++
+++++++[[>>>>>>>>>]<<<<<<<<<-<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+[>>>>>>>>[-<<<<<<<+
>>>>>>>]<<<<<<<[->>>>>>>+<<<<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>>>>[
-]>>>]<<<<<<<<<[<<<<<<<<<]>>>>+>[-<-<<<<+>>>>>]>[-<<<<<<[->>>>>+<++<<<<]>>>>>[-<
<<<<+>>>>>]<->+>]<[->+<]<<<<<[->>>>>+<<<<<]>>>>>>[-]<<<<<<+>>>>[-<<<<->>>>]+<<<<
[->>>>->>>>>[>>[-<<->>]+<<[->>->[-<<<+>>>]<<<[->>>+<<<<<<<<<<<<[<<<<<<<<<]>>>[-]
+>>>>>>[>>>>>>>>>]>+<]]+>>>[-<<<->>>]+<<<[->>>-<[-<<+>>]<<[->>+<<<<<<<<<<<[<<<<<
<<<<]>>>>[-]+>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>>>>>>>>]<<<<<<<<]>>>>>>>>]<<<<<<<<<
[<<<<<<<<<]>>>>[-<<<<+>>>>]<<<<[->>>>+>>>>>[>+>>[-<<->>]<<[->>+<<]>>>>>>>>]<<<<<
<<<+<[>[->>>>>+<<<<[->>>>-<<<<<<<<<<<<<<+>>>>>>>>>>>[->>>+<<<]<]>[->>>-<<<<<<<<<
<<<<<+>>>>>>>>>>>]<<]>[->>>>+<<<[->>>-<<<<<<<<<<<<<<+>>>>>>>>>>>]<]>[->>>+<<<]<<
<<<<<<<<<<]>>>>[-]<<<<]>>>[-<<<+>>>]<<<[->>>+>>>>>>[>+>[-<->]<[->+<]>>>>>>>>]<<<
<<<<<+<[>[->>>>>+<<<[->>>-<<<<<<<<<<<<<<+>>>>>>>>>>[->>>>+<<<<]>]<[->>>>-<<<<<<<
<<<<<<<+>>>>>>>>>>]<]>>[->>>+<<<<[->>>>-<<<<<<<<<<<<<<+>>>>>>>>>>]>]<[->>>>+<<<<
]<<<<<<<<<<<]>>>>>>+<<<<<<]]>>>>[-<<<<+>>>>]<<<<[->>>>+>>>>>[>>>>>>>>>]<<<<<<<<<
[>[->>>>>+<<<<[->>>>-<<<<<<<<<<<<<<+>>>>>>>>>>>[->>>+<<<]<]>[->>>-<<<<<<<<<<<<<<
+>>>>>>>>>>>]<<]>[->>>>+<<<[->>>-<<<<<<<<<<<<<<+>>>>>>>>>>>]<]>[->>>+<<<]<<<<<<<
<<<<<]]>[-]>>[-]>[-]>>>>>[>>[-]>[-]>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>>>[-<
<<<+>>>>]<<<<[->>>>+<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>+++++++++++++++[
[>>>>>>>>>]+>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+
[>+>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>[-<<<<+>>>>]<<<<[->>>>+<<<<<[->>
[-<<+>>]<<[->>+>+<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>>>>]<<<<<<<<
<[>[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<]>[->>>>>>>>>+<<<<<<<<<]<+>>>>>>>>]<<<<<<<<<[
>[-]<->>>[-<<<+>[<->-<<<<<<<+>>>>>>>]<[->+<]>>>]<<[->>+<<]<+<<<<<<<<<]>>>>>>>>>[
>>>[-<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<+>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>]>
>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>[-]>>>>+++++++++++++++[[>>>>>>>>>]<<<<<<<<<-<<<<<
<<<<[<<<<<<<<<]>>>>>>>>>-]+[>>>[-<<<->>>]+<<<[->>>->[-<<<<+>>>>]<<<<[->>>>+<<<<<
<<<<<<<<[<<<<<<<<<]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>>>[-<<<<->>>>]+<<<<[->>>>-<[-
<<<+>>>]<<<[->>>+<<<<<<<<<<<<[<<<<<<<<<]>>>[-]+>>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>
>>>>>>>]<<<<<<<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>[-<<<+>>>]<<<[->>>+>>>>>>[>+>>>
[-<<<->>>]<<<[->>>+<<<]>>>>>>>>]<<<<<<<<+<[>[->+>[-<-<<<<<<<<<<+>>>>>>>>>>>>[-<<
+>>]<]>[-<<-<<<<<<<<<<+>>>>>>>>>>>>]<<<]>>[-<+>>[-<<-<<<<<<<<<<+>>>>>>>>>>>>]<]>
[-<<+>>]<<<<<<<<<<<<<]]>>>>[-<<<<+>>>>]<<<<[->>>>+>>>>>[>+>>[-<<->>]<<[->>+<<]>>
>>>>>>]<<<<<<<<+<[>[->+>>[-<<-<<<<<<<<<<+>>>>>>>>>>>[-<+>]>]<[-<-<<<<<<<<<<+>>>>
>>>>>>>]<<]>>>[-<<+>[-<-<<<<<<<<<<+>>>>>>>>>>>]>]<[-<+>]<<<<<<<<<<<<]>>>>>+<<<<<
]>>>>>>>>>[>>>[-]>[-]>[-]>>>>]<<<<<<<<<[<<<<<<<<<]>>>[-]>[-]>>>>>[>>>>>>>[-<<<<<
<+>>>>>>]<<<<<<[->>>>>>+<<<<+<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>+>[-<-<<<<+>>>>
>]>>[-<<<<<<<[->>>>>+<++<<<<]>>>>>[-<<<<<+>>>>>]<->+>>]<<[->>+<<]<<<<<[->>>>>+<<
<<<]+>>>>[-<<<<->>>>]+<<<<[->>>>->>>>>[>>>[-<<<->>>]+<<<[->>>-<[-<<+>>]<<[->>+<<
<<<<<<<<<[<<<<<<<<<]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>[-<<->>]+<<[->>->[-<<<+>>>]<
<<[->>>+<<<<<<<<<<<<[<<<<<<<<<]>>>[-]+>>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>>>>>>>>]<
<<<<<<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>[-<<<+>>>]<<<[->>>+>>>>>>[>+>[-<->]<[->+
<]>>>>>>>>]<<<<<<<<+<[>[->>>>+<<[->>-<<<<<<<<<<<<<+>>>>>>>>>>[->>>+<<<]>]<[->>>-
<<<<<<<<<<<<<+>>>>>>>>>>]<]>>[->>+<<<[->>>-<<<<<<<<<<<<<+>>>>>>>>>>]>]<[->>>+<<<
]<<<<<<<<<<<]>>>>>[-]>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+<<+<<<<<]]>>>>[-<<<<+>
>>>]<<<<[->>>>+>>>>>[>+>>[-<<->>]<<[->>+<<]>>>>>>>>]<<<<<<<<+<[>[->>>>+<<<[->>>-
<<<<<<<<<<<<<+>>>>>>>>>>>[->>+<<]<]>[->>-<<<<<<<<<<<<<+>>>>>>>>>>>]<<]>[->>>+<<[
->>-<<<<<<<<<<<<<+>>>>>>>>>>>]<]>[->>+<<]<<<<<<<<<<<<]]>>>>[-]<<<<]>>>>[-<<<<+>>
>>]<<<<[->>>>+>[-]>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+<<+<<<<<]>>>>>>>>>[>>>>>>
>>>]<<<<<<<<<[>[->>>>+<<<[->>>-<<<<<<<<<<<<<+>>>>>>>>>>>[->>+<<]<]>[->>-<<<<<<<<
<<<<<+>>>>>>>>>>>]<<]>[->>>+<<[->>-<<<<<<<<<<<<<+>>>>>>>>>>>]<]>[->>+<<]<<<<<<<<
<<<<]]>>>>>>>>>[>>[-]>[-]>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>[-]>[-]>>>>>[>>>>>[-<<<<+
>>>>]<<<<[->>>>+<<<+<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>>>>[-<<<<<+>>>>>
]<<<<<[->>>>>+<<<+<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>+++++++++++++++[[>>>>
>>>>>]+>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]>[-]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+[>+>>
>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>[-<<<<+>>>>]<<<<[->>>>+<<<<<[->>[-<<+
>>]<<[->>+>>+<<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>>>>]<<<<<<<<<[>
[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<]>[->>>>>>>>>+<<<<<<<<<]<+>>>>>>>>]<<<<<<<<<[>[-
]<->>>>[-<<<<+>[<->-<<<<<<+>>>>>>]<[->+<]>>>>]<<<[->>>+<<<]<+<<<<<<<<<]>>>>>>>>>
[>+>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>->>>>>[-<<<<<+>>>>>]<<<<<[->>>>>+<<<<
<<[->>>[-<<<+>>>]<<<[->>>+>+<<<<]+>>>>>>>>>]<<<<<<<<[<<<<<<<<<]]>>>>>>>>>[>>>>>>
>>>]<<<<<<<<<[>>[->>>>>>>>>+<<<<<<<<<]<<<<<<<<<<<]>>[->>>>>>>>>+<<<<<<<<<]<<+>>>
>>>>>]<<<<<<<<<[>[-]<->>>>[-<<<<+>[<->-<<<<<<+>>>>>>]<[->+<]>>>>]<<<[->>>+<<<]<+
<<<<<<<<<]>>>>>>>>>[>>>>[-<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<+>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>]>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>+++++++++++++++[[>>>>>>>>
>]<<<<<<<<<-<<<<<<<<<[<<<<<<<<<]>>>>>>>>>-]+>>>>>>>>>>>>>>>>>>>>>+<<<[<<<<<<<<<]
>>>>>>>>>[>>>[-<<<->>>]+<<<[->>>->[-<<<<+>>>>]<<<<[->>>>+<<<<<<<<<<<<<[<<<<<<<<<
]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>>>[-<<<<->>>>]+<<<<[->>>>-<[-<<<+>>>]<<<[->>>+<
<<<<<<<<<<<[<<<<<<<<<]>>>[-]+>>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>>>>>>>>]<<<<<<<<]>
>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>->>[-<<<<+>>>>]<<<<[->>>>+<<[-]<<]>>]<<+>>>>[-<<<<
->>>>]+<<<<[->>>>-<<<<<<.>>]>>>>[-<<<<<<<.>>>>>>>]<<<[-]>[-]>[-]>[-]>[-]>[-]>>>[
>[-]>[-]>[-]>[-]>[-]>[-]>>>]<<<<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>>>[-]>>>>]<<<<<<<<<
[<<<<<<<<<]>+++++++++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>+>>>>>>>>>+<<<<<<<<
<<<<<<[<<<<<<<<<]>>>>>>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+[-]>>[>>>>>>>>>]<<<<<
<<<<[>>>>>>>[-<<<<<<+>>>>>>]<<<<<<[->>>>>>+<<<<<<<[<<<<<<<<<]>>>>>>>[-]+>>>]<<<<
<<<<<<]]>>>>>>>[-<<<<<<<+>>>>>>>]<<<<<<<[->>>>>>>+>>[>+>>>>[-<<<<->>>>]<<<<[->>>
>+<<<<]>>>>>>>>]<<+<<<<<<<[>>>>>[->>+<<]<<<<<<<<<<<<<<]>>>>>>>>>[>>>>>>>>>]<<<<<
<<<<[>[-]<->>>>>>>[-<<<<<<<+>[<->-<<<+>>>]<[->+<]>>>>>>>]<<<<<<[->>>>>>+<<<<<<]<
+<<<<<<<<<]>>>>>>>-<<<<[-]+<<<]+>>>>>>>[-<<<<<<<->>>>>>>]+<<<<<<<[->>>>>>>->>[>>
>>>[->>+<<]>>>>]<<<<<<<<<[>[-]<->>>>>>>[-<<<<<<<+>[<->-<<<+>>>]<[->+<]>>>>>>>]<<
<<<<[->>>>>>+<<<<<<]<+<<<<<<<<<]>+++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>+<<<
<<[<<<<<<<<<]>>>>>>>>>[>>>>>[-<<<<<->>>>>]+<<<<<[->>>>>->>[-<<<<<<<+>>>>>>>]<<<<
<<<[->>>>>>>+<<<<<<<<<<<<<<<<[<<<<<<<<<]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>>>>>>[-<
<<<<<<->>>>>>>]+<<<<<<<[->>>>>>>-<<[-<<<<<+>>>>>]<<<<<[->>>>>+<<<<<<<<<<<<<<[<<<
<<<<<<]>>>[-]+>>>>>>[>>>>>>>>>]>[-]+<]]+>[-<[>>>>>>>>>]<<<<<<<<]>>>>>>>>]<<<<<<<
<<[<<<<<<<<<]>>>>[-]<<<+++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>-<<<<<[<<<<<<<
<<]]>>>]<<<<.>>>>>>>>>>[>>>>>>[-]>>>]<<<<<<<<<[<<<<<<<<<]>++++++++++[-[->>>>>>>>
>+<<<<<<<<<]>>>>>>>>>]>>>>>+>>>>>>>>>+<<<<<<<<<<<<<<<[<<<<<<<<<]>>>>>>>>[-<<<<<<
<<+>>>>>>>>]<<<<<<<<[->>>>>>>>+[-]>[>>>>>>>>>]<<<<<<<<<[>>>>>>>>[-<<<<<<<+>>>>>>
>]<<<<<<<[->>>>>>>+<<<<<<<<[<<<<<<<<<]>>>>>>>>[-]+>>]<<<<<<<<<<]]>>>>>>>>[-<<<<<
<<<+>>>>>>>>]<<<<<<<<[->>>>>>>>+>[>+>>>>>[-<<<<<->>>>>]<<<<<[->>>>>+<<<<<]>>>>>>
>>]<+<<<<<<<<[>>>>>>[->>+<<]<<<<<<<<<<<<<<<]>>>>>>>>>[>>>>>>>>>]<<<<<<<<<[>[-]<-
>>>>>>>>[-<<<<<<<<+>[<->-<<+>>]<[->+<]>>>>>>>>]<<<<<<<[->>>>>>>+<<<<<<<]<+<<<<<<
<<<]>>>>>>>>-<<<<<[-]+<<<]+>>>>>>>>[-<<<<<<<<->>>>>>>>]+<<<<<<<<[->>>>>>>>->[>>>
>>>[->>+<<]>>>]<<<<<<<<<[>[-]<->>>>>>>>[-<<<<<<<<+>[<->-<<+>>]<[->+<]>>>>>>>>]<<
<<<<<[->>>>>>>+<<<<<<<]<+<<<<<<<<<]>+++++[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>>
+>>>>>>>>>>>>>>>>>>>>>>>>>>>+<<<<<<[<<<<<<<<<]>>>>>>>>>[>>>>>>[-<<<<<<->>>>>>]+<
<<<<<[->>>>>>->>[-<<<<<<<<+>>>>>>>>]<<<<<<<<[->>>>>>>>+<<<<<<<<<<<<<<<<<[<<<<<<<
<<]>>>>[-]+>>>>>[>>>>>>>>>]>+<]]+>>>>>>>>[-<<<<<<<<->>>>>>>>]+<<<<<<<<[->>>>>>>>
-<<[-<<<<<<+>>>>>>]<<<<<<[->>>>>>+<<<<<<<<<<<<<<<[<<<<<<<<<]>>>[-]+>>>>>>[>>>>>>
>>>]>[-]+<]]+>[-<[>>>>>>>>>]<<<<<<<<]>>>>>>>>]<<<<<<<<<[<<<<<<<<<]>>>>[-]<<<++++
+[-[->>>>>>>>>+<<<<<<<<<]>>>>>>>>>]>>>>>->>>>>>>>>>>>>>>>>>>>>>>>>>>-<<<<<<[<<<<
<<<<<]]>>>]";
            //rawcode = "++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++.------.--------.>>+.>++.";

            var p = new string(rawcode.Where(c => c == '[' || c == ']' || c == '>' || c == '<' || c == '+' || c == '-' || c == '.' || c == ',').ToArray());
            //p = "+<[-<+>>>>+<<[-]]";
            pos = 0;
            var parsed = parse(p).ToList();
            var serialized = string.Join("", parsed.Select(p => p.ToString()));
            if (p != serialized)
                throw new Exception();
            var optimized = optimize(parsed);
            serialized = string.Join("", optimized.Select(p => p.ToString()));
            if (p != serialized)
                throw new Exception();
            var compiled = compile(optimized);
            compiled.Add(i_end);

#if DEBUG
            //var allInstrs = recurse(optimized).ToList();
            //var positions = allInstrs.OrderBy(i => i.CompiledPos).Select(i => i.CompiledPos).ToList();
            var heat = new[] { 1, 0, 1, 0, 13, 0, 13, 0, 13, 0, 13, 0, 13, 0, 13, 13, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 15, 0, 0, 15, 0, 15, 0, 0, 15, 0, 15, 0, 15, 15, 0, 1, 0, 1, 0, 16, 0, 16, 0, 16, 16, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 5, 0, 5, 0, 10, 0, 10, 0, 11, 11, 0, 5, 0, 5, 5, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 30, 0, 30, 0, 480, 0, 480, 0, 480, 480, 0, 30, 0, 30, 0, 0, 30, 0, 30, 0, 30, 0, 30, 0, 120, 0, 120, 0, 180, 0, 180, 0, 210, 210, 0, 120, 0, 120, 120, 0, 30, 0, 30, 0, 30, 0, 30, 0, 210, 0, 210, 0, 630, 0, 630, 0, 660, 660, 0, 210, 0, 210, 210, 0, 30, 0, 30, 0, 30, 0, 0, 30, 0, 30, 0, 0, 3780, 0, 3780, 0, 3780, 0, 60480, 0, 60480, 0, 14565, 0, 14565, 0, 60480, 60480, 0, 60480, 0, 60480, 0, 14565, 0, 14565, 0, 14565, 0, 14565, 0, 60480, 60480, 0, 60480, 0, 60480, 60480, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 60480, 0, 60480, 0, 10605, 0, 10605, 0, 60480, 60480, 0, 60480, 0, 60480, 0, 10605, 0, 10605, 0, 10605, 0, 10605, 0, 60480, 60480, 0, 60480, 0, 60480, 60480, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 2562, 0, 2562, 0, 3780, 3780, 0, 3780, 0, 3780, 0, 2562, 0, 2562, 0, 2562, 0, 3780, 3780, 0, 3780, 0, 3780, 0, 3780, 0, 60480, 0, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 60480, 0, 0, 60480, 0, 60480, 0, 60480, 60480, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 0, 14565, 0, 14565, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 14565, 0, 14565, 0, 14565, 0, 354806, 0, 354806, 0, 63431, 0, 63431, 0, 354806, 354806, 0, 354806, 0, 354806, 0, 63431, 0, 63431, 0, 63431, 0, 354806, 354806, 0, 354806, 0, 354806, 354806, 0, 14565, 0, 14565, 0, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 0, 120960, 0, 120960, 0, 1874880, 0, 1874880, 0, 354806, 0, 354806, 0, 1874880, 1874880, 0, 1874880, 0, 1878660, 1878660, 0, 120960, 0, 120960, 0, 0, 0, 0, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 0, 120960, 0, 105745, 0, 105745, 0, 105745, 0, 42314, 0, 42314, 0, 42314, 0, 42314, 0, 105745, 105745, 0, 105745, 0, 105745, 0, 63431, 0, 63431, 0, 105745, 105745, 0, 105745, 0, 190063, 190063, 0, 120960, 0, 120960, 0, 21117, 0, 21117, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 0, 10605, 0, 10605, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 10605, 0, 10605, 0, 10605, 0, 259473, 0, 259473, 0, 35067, 0, 35067, 0, 259473, 259473, 0, 259473, 0, 259473, 0, 35067, 0, 35067, 0, 35067, 0, 259473, 259473, 0, 259473, 0, 259473, 259473, 0, 10605, 0, 10605, 0, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 0, 120960, 0, 120960, 0, 1874880, 0, 1874880, 0, 259473, 0, 259473, 0, 1874880, 1874880, 0, 1874880, 0, 1878660, 1878660, 0, 120960, 0, 120960, 0, 0, 0, 0, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 120960, 0, 120960, 0, 87016, 0, 87016, 0, 87016, 0, 30832, 0, 30832, 0, 30832, 0, 30832, 0, 87016, 87016, 0, 87016, 0, 87016, 0, 56184, 0, 56184, 0, 87016, 87016, 0, 87016, 0, 169580, 169580, 0, 120960, 0, 120960, 0, 25352, 0, 25352, 0, 120960, 120960, 0, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 120960, 0, 120960, 0, 25352, 0, 25352, 0, 120960, 120960, 0, 120960, 0, 120960, 120960, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 3780, 0, 60480, 0, 0, 60480, 0, 60480, 0, 60480, 0, 0, 60480, 0, 60480, 0, 60480, 60480, 0, 3780, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 12054, 0, 12054, 0, 3780, 0, 3780, 0, 12054, 12054, 0, 12054, 0, 12054, 0, 8274, 0, 8274, 0, 8274, 0, 157, 0, 157, 0, 8274, 8274, 0, 8274, 0, 8274, 0, 157, 0, 157, 0, 157, 0, 0, 157, 0, 157, 0, 157, 0, 0, 157, 0, 157, 0, 8274, 8274, 0, 12054, 12054, 0, 12054, 0, 12054, 0, 314, 0, 314, 0, 12054, 12054, 0, 12054, 0, 12054, 0, 11740, 0, 11740, 0, 11740, 0, 3623, 0, 3623, 0, 11740, 11740, 0, 11740, 0, 11740, 0, 3623, 0, 3623, 0, 3623, 0, 0, 3623, 0, 3623, 0, 3623, 0, 0, 3623, 0, 3623, 0, 11740, 11740, 0, 12054, 12054, 0, 12054, 0, 12054, 0, 3780, 0, 3780, 0, 0, 3780, 0, 12054, 12054, 0, 12054, 0, 12054, 12054, 0, 3780, 0, 3780, 0, 0, 3780, 0, 3780, 0, 38485, 0, 38485, 0, 38485, 0, 38643, 38643, 0, 3780, 0, 3780, 0, 3780, 0, 157, 0, 157, 0, 3780, 3780, 0, 3780, 0, 3780, 0, 157, 0, 157, 0, 157, 0, 157, 0, 3780, 3780, 0, 3780, 0, 3780, 0, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 189278, 0, 189278, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 189278, 0, 189278, 0, 189278, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 189278, 0, 189278, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 168077, 0, 3644334, 0, 3644334, 0, 831368, 0, 831368, 0, 3644334, 3644334, 0, 3644334, 0, 3644334, 0, 831368, 0, 831368, 0, 831368, 0, 3644334, 3644334, 0, 3644334, 0, 3644334, 3644334, 0, 168077, 0, 168077, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 0, 1231840, 0, 1231840, 0, 19093520, 0, 19093520, 0, 4334362, 0, 4334362, 0, 19093520, 19093520, 0, 19093520, 0, 19132015, 19132015, 0, 1231840, 0, 1231840, 0, 0, 0, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1355703, 0, 1355703, 0, 1355703, 0, 524335, 0, 524335, 0, 524335, 0, 524335, 0, 1355703, 1355703, 0, 1355703, 0, 1355703, 0, 831368, 0, 831368, 0, 1355703, 1355703, 0, 1355703, 0, 2075938, 2075938, 0, 1231840, 0, 1231840, 0, 307033, 0, 307033, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 168077, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 168077, 0, 168077, 0, 168077, 0, 3644334, 0, 3644334, 0, 881943, 0, 881943, 0, 3644334, 3644334, 0, 3644334, 0, 3644334, 0, 881943, 0, 881943, 0, 881943, 0, 3644334, 3644334, 0, 3644334, 0, 3644334, 3644334, 0, 168077, 0, 168077, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 0, 1231840, 0, 1231840, 0, 19093520, 0, 19093520, 0, 3644334, 0, 3644334, 0, 19093520, 19093520, 0, 19093520, 0, 19132015, 19132015, 0, 1231840, 0, 1231840, 0, 0, 0, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1498008, 0, 1498008, 0, 1498008, 0, 616065, 0, 616065, 0, 616065, 0, 616065, 0, 1498008, 1498008, 0, 1498008, 0, 1498008, 0, 881943, 0, 881943, 0, 1498008, 1498008, 0, 1498008, 0, 2262369, 2262369, 0, 1231840, 0, 1231840, 0, 265878, 0, 265878, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 265878, 0, 265878, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 307033, 0, 307033, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 93519, 0, 93519, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 93519, 0, 93519, 0, 93519, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 27052, 0, 27052, 0, 27052, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 6535, 0, 6535, 0, 3829, 0, 3829, 0, 3829, 0, 6535, 6535, 0, 6535, 0, 6535, 0, 3829, 0, 3829, 0, 6535, 6535, 0, 6535, 0, 6535, 0, 6535, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 6535, 0, 6535, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 27052, 0, 27052, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 12566, 0, 12566, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 0, 25929, 0, 25929, 0, 25929, 0, 207821, 0, 207821, 0, 20416, 0, 20416, 0, 207821, 207821, 0, 207821, 0, 207821, 0, 187405, 0, 187405, 0, 187405, 0, 7367, 0, 7367, 0, 187405, 187405, 0, 187405, 0, 187405, 0, 7367, 0, 7367, 0, 7367, 0, 0, 7367, 0, 7367, 0, 7367, 0, 0, 7367, 0, 7367, 0, 187405, 187405, 0, 207821, 207821, 0, 207821, 0, 207821, 0, 11011, 0, 11011, 0, 207821, 207821, 0, 207821, 0, 207821, 0, 196810, 0, 196810, 0, 196810, 0, 16772, 0, 16772, 0, 196810, 196810, 0, 196810, 0, 196810, 0, 16772, 0, 16772, 0, 16772, 0, 0, 16772, 0, 16772, 0, 16772, 0, 0, 16772, 0, 16772, 0, 196810, 196810, 0, 207821, 207821, 0, 207821, 0, 207821, 0, 24139, 0, 24139, 0, 0, 24139, 0, 207821, 207821, 0, 207821, 0, 207821, 207821, 0, 25929, 0, 25929, 0, 0, 25929, 0, 25929, 0, 16772, 0, 16772, 0, 25929, 25929, 0, 25929, 0, 25929, 0, 16772, 0, 16772, 0, 16772, 0, 268352, 0, 268352, 0, 268352, 0, 67400, 0, 67400, 0, 268352, 268352, 0, 268352, 0, 268352, 0, 200952, 0, 200952, 0, 268352, 268352, 0, 268352, 0, 268352, 268352, 0, 16772, 0, 16772, 0, 16772, 0, 268352, 0, 268352, 0, 166049, 0, 166049, 0, 166049, 0, 15542, 0, 15542, 0, 15542, 0, 15542, 0, 11275, 0, 11275, 0, 15542, 15542, 0, 15542, 0, 166049, 166049, 0, 166049, 0, 166049, 0, 130878, 0, 130878, 0, 130878, 0, 166049, 166049, 0, 166049, 0, 268352, 268352, 0, 268352, 0, 268352, 0, 28585, 0, 28585, 0, 28585, 0, 19629, 0, 19629, 0, 19629, 0, 28585, 28585, 0, 28585, 0, 268352, 268352, 0, 268352, 0, 268352, 0, 39170, 0, 39170, 0, 268352, 268352, 0, 268352, 0, 268352, 268352, 0, 16772, 0, 16772, 0, 25929, 25929, 0, 25929, 0, 25929, 0, 7367, 0, 7367, 0, 25929, 25929, 0, 25929, 0, 25929, 0, 7367, 0, 7367, 0, 7367, 0, 117872, 0, 117872, 0, 117872, 0, 19343, 0, 19343, 0, 117872, 117872, 0, 117872, 0, 117872, 0, 98529, 0, 98529, 0, 117872, 117872, 0, 117872, 0, 117872, 117872, 0, 7367, 0, 7367, 0, 7367, 0, 117872, 0, 117872, 0, 103245, 0, 103245, 0, 103245, 0, 32073, 0, 32073, 0, 32073, 0, 32073, 0, 24478, 0, 24478, 0, 32073, 32073, 0, 32073, 0, 103245, 103245, 0, 103245, 0, 103245, 0, 64634, 0, 64634, 0, 64634, 0, 103245, 103245, 0, 103245, 0, 117872, 117872, 0, 117872, 0, 117872, 0, 8976, 0, 8976, 0, 8976, 0, 6538, 0, 6538, 0, 6538, 0, 8976, 8976, 0, 8976, 0, 117872, 117872, 0, 117872, 0, 117872, 0, 2879, 0, 2879, 0, 117872, 117872, 0, 117872, 0, 117872, 117872, 0, 7367, 0, 7367, 0, 25929, 25929, 0, 38495, 38495, 0, 0, 38495, 0, 38495, 0, 12566, 0, 12566, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 12566, 0, 12566, 0, 12566, 0, 0, 12566, 0, 12566, 0, 201056, 0, 201056, 0, 18884, 0, 18884, 0, 18884, 0, 7045, 0, 7045, 0, 7045, 0, 7045, 0, 2565, 0, 2565, 0, 7045, 7045, 0, 7045, 0, 18884, 18884, 0, 18884, 0, 18884, 0, 3399, 0, 3399, 0, 3399, 0, 18884, 18884, 0, 18884, 0, 201056, 201056, 0, 201056, 0, 201056, 0, 22972, 0, 22972, 0, 22972, 0, 8440, 0, 8440, 0, 8440, 0, 22972, 22972, 0, 22972, 0, 201056, 201056, 0, 201056, 0, 201056, 0, 37297, 0, 37297, 0, 201056, 201056, 0, 201056, 0, 201056, 201056, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 189278, 0, 189278, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 189278, 0, 189278, 0, 189278, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 189278, 0, 189278, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 189278, 0, 189278, 0, 189278, 0, 4145084, 0, 4145084, 0, 1032474, 0, 1032474, 0, 4145084, 4145084, 0, 4145084, 0, 4145084, 0, 1032474, 0, 1032474, 0, 1032474, 0, 4145084, 4145084, 0, 4145084, 0, 4145084, 4145084, 0, 189278, 0, 189278, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 0, 1231840, 0, 1231840, 0, 19093520, 0, 19093520, 0, 4145084, 0, 4145084, 0, 19093520, 19093520, 0, 19093520, 0, 19132015, 19132015, 0, 1231840, 0, 1231840, 0, 0, 0, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1761819, 0, 1761819, 0, 1761819, 0, 729345, 0, 729345, 0, 729345, 0, 729345, 0, 1761819, 1761819, 0, 1761819, 0, 1761819, 0, 1032474, 0, 1032474, 0, 1761819, 1761819, 0, 1761819, 0, 2459060, 2459060, 0, 1231840, 0, 1231840, 0, 303129, 0, 303129, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 303129, 0, 303129, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 314067, 0, 314067, 0, 28046, 0, 28046, 0, 314067, 314067, 0, 314067, 0, 314067, 0, 286021, 0, 286021, 0, 286021, 0, 15336, 0, 15336, 0, 286021, 286021, 0, 286021, 0, 286021, 0, 15336, 0, 15336, 0, 15336, 0, 0, 15336, 0, 15336, 0, 15336, 0, 0, 15336, 0, 15336, 0, 286021, 286021, 0, 314067, 314067, 0, 314067, 0, 314067, 0, 20410, 0, 20410, 0, 314067, 314067, 0, 314067, 0, 314067, 0, 293657, 0, 293657, 0, 293657, 0, 22972, 0, 22972, 0, 293657, 293657, 0, 293657, 0, 293657, 0, 22972, 0, 22972, 0, 22972, 0, 0, 22972, 0, 22972, 0, 22972, 0, 0, 22972, 0, 22972, 0, 293657, 293657, 0, 314067, 314067, 0, 314067, 0, 314067, 0, 38308, 0, 38308, 0, 0, 38308, 0, 314067, 314067, 0, 314067, 0, 314067, 314067, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 22972, 0, 22972, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 22972, 0, 22972, 0, 22972, 0, 367552, 0, 367552, 0, 367552, 0, 62522, 0, 62522, 0, 367552, 367552, 0, 367552, 0, 367552, 0, 305030, 0, 305030, 0, 367552, 367552, 0, 367552, 0, 367552, 367552, 0, 22972, 0, 22972, 0, 22972, 0, 367552, 0, 367552, 0, 310252, 0, 310252, 0, 310252, 0, 82742, 0, 82742, 0, 82742, 0, 82742, 0, 60843, 0, 60843, 0, 82742, 82742, 0, 82742, 0, 310252, 310252, 0, 310252, 0, 310252, 0, 206650, 0, 206650, 0, 206650, 0, 310252, 310252, 0, 310252, 0, 367552, 367552, 0, 367552, 0, 367552, 0, 30379, 0, 30379, 0, 30379, 0, 20860, 0, 20860, 0, 20860, 0, 30379, 30379, 0, 30379, 0, 367552, 367552, 0, 367552, 0, 367552, 0, 16677, 0, 16677, 0, 367552, 367552, 0, 367552, 0, 367552, 367552, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 15336, 0, 15336, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 15336, 0, 15336, 0, 15336, 0, 245376, 0, 245376, 0, 245376, 0, 47581, 0, 47581, 0, 245376, 245376, 0, 245376, 0, 245376, 0, 197795, 0, 197795, 0, 245376, 245376, 0, 245376, 0, 245376, 245376, 0, 15336, 0, 15336, 0, 15336, 0, 245376, 0, 245376, 0, 201344, 0, 201344, 0, 201344, 0, 47174, 0, 47174, 0, 47174, 0, 47174, 0, 31183, 0, 31183, 0, 47174, 47174, 0, 47174, 0, 201344, 201344, 0, 201344, 0, 201344, 0, 138794, 0, 138794, 0, 138794, 0, 201344, 201344, 0, 201344, 0, 245376, 245376, 0, 245376, 0, 245376, 0, 22973, 0, 22973, 0, 22973, 0, 15376, 0, 15376, 0, 15376, 0, 22973, 22973, 0, 22973, 0, 245376, 245376, 0, 245376, 0, 245376, 0, 12442, 0, 12442, 0, 245376, 245376, 0, 245376, 0, 245376, 245376, 0, 15336, 0, 15336, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 129552, 0, 129552, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 129552, 0, 129552, 0, 129552, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 15336, 0, 15336, 0, 15336, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 28671, 0, 28671, 0, 8773, 0, 8773, 0, 8773, 0, 28671, 28671, 0, 28671, 0, 28671, 0, 8773, 0, 8773, 0, 28671, 28671, 0, 28671, 0, 28671, 0, 28671, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 28671, 0, 28671, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 15336, 0, 15336, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 12034, 0, 12034, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 0, 26461, 0, 26461, 0, 26461, 0, 185653, 0, 185653, 0, 28008, 0, 28008, 0, 185653, 185653, 0, 185653, 0, 185653, 0, 157645, 0, 157645, 0, 157645, 0, 7089, 0, 7089, 0, 157645, 157645, 0, 157645, 0, 157645, 0, 7089, 0, 7089, 0, 7089, 0, 0, 7089, 0, 7089, 0, 7089, 0, 0, 7089, 0, 7089, 0, 157645, 157645, 0, 185653, 185653, 0, 185653, 0, 185653, 0, 15767, 0, 15767, 0, 185653, 185653, 0, 185653, 0, 185653, 0, 169886, 0, 169886, 0, 169886, 0, 19330, 0, 19330, 0, 169886, 169886, 0, 169886, 0, 169886, 0, 19330, 0, 19330, 0, 19330, 0, 0, 19330, 0, 19330, 0, 19330, 0, 0, 19330, 0, 19330, 0, 169886, 169886, 0, 185653, 185653, 0, 185653, 0, 185653, 0, 26419, 0, 26419, 0, 0, 26419, 0, 185653, 185653, 0, 185653, 0, 185653, 185653, 0, 26461, 0, 26461, 0, 0, 26461, 0, 26461, 0, 19330, 0, 19330, 0, 26461, 26461, 0, 26461, 0, 26461, 0, 19330, 0, 19330, 0, 19330, 0, 309280, 0, 309280, 0, 309280, 0, 81884, 0, 81884, 0, 309280, 309280, 0, 309280, 0, 309280, 0, 227396, 0, 227396, 0, 309280, 309280, 0, 309280, 0, 309280, 309280, 0, 19330, 0, 19330, 0, 19330, 0, 309280, 0, 309280, 0, 198554, 0, 198554, 0, 198554, 0, 29192, 0, 29192, 0, 29192, 0, 29192, 0, 19065, 0, 19065, 0, 29192, 29192, 0, 29192, 0, 198554, 198554, 0, 198554, 0, 198554, 0, 143591, 0, 143591, 0, 143591, 0, 198554, 198554, 0, 198554, 0, 309280, 309280, 0, 309280, 0, 309280, 0, 38853, 0, 38853, 0, 38853, 0, 25771, 0, 25771, 0, 25771, 0, 38853, 38853, 0, 38853, 0, 309280, 309280, 0, 309280, 0, 309280, 0, 38969, 0, 38969, 0, 309280, 309280, 0, 309280, 0, 309280, 309280, 0, 19330, 0, 19330, 0, 19330, 0, 15512, 0, 15512, 0, 19330, 19330, 0, 19330, 0, 19330, 0, 15512, 0, 15512, 0, 15512, 0, 19330, 19330, 0, 26461, 26461, 0, 26461, 0, 26461, 0, 7089, 0, 7089, 0, 26461, 26461, 0, 26461, 0, 26461, 0, 7089, 0, 7089, 0, 7089, 0, 113424, 0, 113424, 0, 113424, 0, 24256, 0, 24256, 0, 113424, 113424, 0, 113424, 0, 113424, 0, 89168, 0, 89168, 0, 113424, 113424, 0, 113424, 0, 113424, 113424, 0, 7089, 0, 7089, 0, 7089, 0, 113424, 0, 113424, 0, 96101, 0, 96101, 0, 96101, 0, 31114, 0, 31114, 0, 31114, 0, 31114, 0, 21022, 0, 21022, 0, 31114, 31114, 0, 31114, 0, 96101, 96101, 0, 96101, 0, 96101, 0, 57848, 0, 57848, 0, 57848, 0, 96101, 96101, 0, 96101, 0, 113424, 113424, 0, 113424, 0, 113424, 0, 10345, 0, 10345, 0, 10345, 0, 7139, 0, 7139, 0, 7139, 0, 10345, 10345, 0, 10345, 0, 113424, 113424, 0, 113424, 0, 113424, 0, 3159, 0, 3159, 0, 113424, 113424, 0, 113424, 0, 113424, 113424, 0, 26461, 26461, 0, 26461, 0, 26461, 0, 38495, 38495, 0, 0, 38495, 0, 38495, 0, 12034, 0, 12034, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 12034, 0, 12034, 0, 12034, 0, 12034, 0, 12034, 0, 8773, 0, 8773, 0, 12034, 12034, 0, 12034, 0, 12034, 0, 8773, 0, 8773, 0, 8773, 0, 12034, 12034, 0, 12034, 0, 12034, 0, 0, 12034, 0, 12034, 0, 192544, 0, 192544, 0, 22927, 0, 22927, 0, 22927, 0, 7576, 0, 7576, 0, 7576, 0, 7576, 0, 3649, 0, 3649, 0, 7576, 7576, 0, 7576, 0, 22927, 22927, 0, 22927, 0, 22927, 0, 6124, 0, 6124, 0, 6124, 0, 22927, 22927, 0, 22927, 0, 192544, 192544, 0, 192544, 0, 192544, 0, 43543, 0, 43543, 0, 43543, 0, 9227, 0, 9227, 0, 9227, 0, 43543, 43543, 0, 43543, 0, 192544, 192544, 0, 192544, 0, 192544, 0, 18216, 0, 18216, 0, 192544, 192544, 0, 192544, 0, 192544, 192544, 0, 38495, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 196821, 0, 196821, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 196821, 0, 196821, 0, 196821, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 615920, 0, 615920, 0, 178197, 0, 178197, 0, 615920, 615920, 0, 615920, 0, 615920, 0, 178197, 0, 178197, 0, 178197, 0, 615920, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 38495, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 615920, 0, 0, 615920, 0, 615920, 0, 615920, 615920, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 196821, 0, 196821, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 196821, 0, 196821, 0, 196821, 0, 4291302, 0, 4291302, 0, 1110427, 0, 1110427, 0, 4291302, 4291302, 0, 4291302, 0, 4291302, 0, 1110427, 0, 1110427, 0, 1110427, 0, 4291302, 4291302, 0, 4291302, 0, 4291302, 4291302, 0, 196821, 0, 196821, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 0, 1231840, 0, 1231840, 0, 19093520, 0, 19093520, 0, 4291302, 0, 4291302, 0, 19093520, 19093520, 0, 19093520, 0, 19132015, 19132015, 0, 1231840, 0, 1231840, 0, 0, 0, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 0, 1902446, 0, 1902446, 0, 1902446, 0, 792019, 0, 792019, 0, 792019, 0, 792019, 0, 1902446, 1902446, 0, 1902446, 0, 1902446, 0, 1110427, 0, 1110427, 0, 1902446, 1902446, 0, 1902446, 0, 2570854, 2570854, 0, 1231840, 0, 1231840, 0, 318408, 0, 318408, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 0, 38495, 0, 38495, 0, 1231840, 0, 1231840, 0, 1231840, 0, 178197, 0, 178197, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 178197, 0, 178197, 0, 178197, 0, 3852933, 0, 3852933, 0, 977191, 0, 977191, 0, 3852933, 3852933, 0, 3852933, 0, 3852933, 0, 977191, 0, 977191, 0, 977191, 0, 3852933, 3852933, 0, 3852933, 0, 3852933, 3852933, 0, 178197, 0, 178197, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 0, 1231840, 0, 1231840, 0, 19093520, 0, 19093520, 0, 3852933, 0, 3852933, 0, 19093520, 19093520, 0, 19093520, 0, 19132015, 19132015, 0, 1231840, 0, 1231840, 0, 0, 0, 0, 0, 1231840, 1231840, 0, 1231840, 0, 1231840, 0, 1231840, 1231840, 0, 38495, 0, 38495, 0, 1231820, 0, 1231820, 0, 1231820, 0, 1231820, 0, 2210267, 0, 2210267, 0, 2210267, 0, 914686, 0, 914686, 0, 914686, 0, 914686, 0, 2210267, 2210267, 0, 2210267, 0, 2210267, 0, 1295581, 0, 1295581, 0, 2210267, 2210267, 0, 2210267, 0, 2790148, 2790147, 0, 1231819, 0, 1231819, 0, 380894, 0, 380894, 0, 1231819, 1231819, 0, 1231819, 0, 1231819, 0, 1231819, 1231819, 0, 38494, 0, 38494, 0, 1231808, 0, 1231808, 0, 380890, 0, 380890, 0, 1231808, 1231808, 0, 1231808, 0, 1231808, 1231808, 0, 38494, 0, 38494, 0, 0, 38494, 0, 38494, 0, 38494, 0, 615904, 0, 0, 615904, 0, 615904, 0, 615904, 0, 0, 615904, 0, 615904, 0, 615904, 615904, 0, 38494, 0, 38494, 0, 38494, 0, 0, 38494, 0, 38494, 0, 117217, 0, 117217, 0, 37316, 0, 37316, 0, 117217, 117217, 0, 117217, 0, 117217, 0, 79901, 0, 79901, 0, 79901, 0, 2526, 0, 2526, 0, 79901, 79901, 0, 79901, 0, 79901, 0, 2526, 0, 2526, 0, 2526, 0, 0, 2526, 0, 2526, 0, 2526, 0, 0, 2526, 0, 2526, 0, 79901, 79901, 0, 117217, 117217, 0, 117217, 0, 117217, 0, 3875, 0, 3875, 0, 117217, 117217, 0, 117217, 0, 117217, 0, 113342, 0, 113342, 0, 113342, 0, 35967, 0, 35967, 0, 113342, 113342, 0, 113342, 0, 113342, 0, 35967, 0, 35967, 0, 35967, 0, 0, 35967, 0, 35967, 0, 35967, 0, 0, 35967, 0, 35967, 0, 113342, 113342, 0, 117217, 117217, 0, 117217, 0, 117217, 0, 38493, 0, 38493, 0, 0, 38493, 0, 117217, 117217, 0, 117217, 0, 117217, 117217, 0, 38494, 0, 38494, 0, 0, 38494, 0, 38494, 0, 38494, 0, 2526, 0, 2526, 0, 38494, 38494, 0, 38494, 0, 38494, 0, 2526, 0, 2526, 0, 2526, 0, 2526, 0, 38494, 38494, 0, 38494, 0, 38651, 38651, 0, 0, 3779, 0, 3779, 0, 3779, 0, 2683, 0, 2683, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 1096, 0, 1096, 0, 1096, 1096, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 2683, 0, 2683, 2683, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 60464, 0, 60464, 0, 60464, 0, 60464, 0, 60464, 0, 60464, 0, 60464, 0, 60464, 60464, 0, 3779, 0, 3779, 0, 0, 3779, 0, 3779, 0, 60464, 0, 60464, 0, 60464, 60464, 0, 3779, 0, 3779, 0, 0, 3779, 0, 3779, 0, 3779, 0, 41569, 0, 41569, 0, 207845, 0, 207845, 0, 211624, 211624, 0, 41569, 0, 41569, 41569, 0, 3779, 0, 3779, 0, 3779, 0, 3779, 0, 0, 3779, 0, 3779, 0, 2561, 0, 2561, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 2561, 0, 2561, 0, 2561, 0, 2561, 0, 2561, 0, 0, 2561, 0, 2561, 0, 15538, 0, 15538, 0, 2532, 0, 2532, 0, 15538, 15538, 0, 15538, 0, 15538, 0, 2532, 0, 2532, 0, 2532, 0, 0, 2532, 0, 2532, 0, 15538, 15538, 0, 15538, 0, 15538, 15538, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 2532, 0, 2532, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 2532, 0, 2532, 0, 2532, 0, 40512, 0, 40512, 0, 40512, 0, 5064, 0, 5064, 0, 40512, 40512, 0, 40512, 0, 40512, 0, 35448, 0, 35448, 0, 40512, 40512, 0, 40512, 0, 40512, 40512, 0, 2532, 0, 2532, 0, 2532, 0, 40512, 0, 40512, 0, 35448, 0, 35448, 0, 40512, 40512, 0, 40512, 0, 40512, 40512, 0, 2532, 0, 2532, 0, 0, 2532, 0, 2532, 0, 40512, 0, 40512, 0, 40512, 0, 40512, 0, 81167, 0, 81167, 0, 81167, 0, 35506, 0, 35506, 0, 35506, 0, 35506, 0, 81167, 81167, 0, 81167, 0, 81167, 0, 45661, 0, 45661, 0, 81167, 81167, 0, 81167, 0, 81785, 81785, 0, 40512, 0, 40512, 0, 10155, 0, 10155, 0, 40512, 40512, 0, 40512, 0, 40512, 0, 40512, 40512, 0, 2532, 0, 2532, 0, 2532, 0, 2532, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 2532, 0, 2532, 0, 3779, 3779, 0, 3779, 0, 3779, 0, 0, 1247, 0, 1247, 0, 1247, 0, 19952, 0, 19952, 0, 2494, 0, 2494, 0, 19952, 19952, 0, 19952, 0, 19952, 19952, 0, 1247, 0, 1247, 0, 19952, 0, 19952, 0, 19952, 0, 19952, 0, 9280, 0, 9280, 0, 9280, 0, 2436, 0, 2436, 0, 2436, 0, 2436, 0, 9280, 9280, 0, 9280, 0, 9280, 0, 6844, 0, 6844, 0, 9280, 9280, 0, 9280, 0, 22707, 22707, 0, 19952, 0, 19952, 0, 4408, 0, 4408, 0, 19952, 19952, 0, 19952, 0, 19952, 0, 19952, 19952, 0, 1247, 0, 1247, 0, 1247, 0, 6235, 0, 6235, 0, 12470, 0, 12470, 0, 13717, 13717, 0, 6235, 0, 6235, 6235, 0, 1247, 0, 1247, 0, 1247, 0, 0, 1247, 0, 1247, 0, 6438, 0, 6438, 0, 1247, 0, 1247, 0, 6438, 6438, 0, 6438, 0, 6438, 0, 5191, 0, 5191, 0, 5191, 0, 29, 0, 29, 0, 5191, 5191, 0, 5191, 0, 5191, 0, 29, 0, 29, 0, 29, 0, 0, 29, 0, 29, 0, 29, 0, 0, 29, 0, 29, 0, 5191, 5191, 0, 6438, 6438, 0, 6438, 0, 6438, 0, 58, 0, 58, 0, 6438, 6438, 0, 6438, 0, 6438, 0, 6380, 0, 6380, 0, 6380, 0, 1218, 0, 1218, 0, 6380, 6380, 0, 6380, 0, 6380, 0, 1218, 0, 1218, 0, 1218, 0, 0, 1218, 0, 1218, 0, 1218, 0, 0, 1218, 0, 1218, 0, 6380, 6380, 0, 6438, 6438, 0, 6438, 0, 6438, 0, 1247, 0, 1247, 0, 0, 1247, 0, 6438, 6438, 0, 6438, 0, 6438, 6438, 0, 1247, 0, 1247, 0, 0, 1247, 0, 1247, 0, 1247, 0, 1247, 0, 6235, 0, 6235, 0, 12470, 0, 12470, 0, 13717, 13717, 0, 6235, 0, 6235, 6235, 0, 1247, 0, 1247, 0, 1247, 0, 0, 3779, 3779, 0, 0, 3779, 0, 3779, 3779, 0, 0, 29, 0, 29, 29, 0, 29, 0, 464, 0, 464, 0, 464, 464, 0, 29, 0, 29, 0, 0, 29, 0, 29, 0, 29, 0, 290, 0, 290, 0, 1305, 0, 1305, 0, 1334, 1334, 0, 290, 0, 290, 290, 0, 29, 0, 29, 0, 29, 0, 29, 0, 0, 29, 0, 29, 0, 25, 0, 25, 0, 29, 29, 0, 29, 0, 29, 0, 25, 0, 25, 0, 25, 0, 25, 0, 25, 0, 0, 25, 0, 25, 0, 182, 0, 182, 0, 24, 0, 24, 0, 182, 182, 0, 182, 0, 182, 0, 24, 0, 24, 0, 24, 0, 0, 24, 0, 24, 0, 182, 182, 0, 182, 0, 182, 182, 0, 29, 29, 0, 29, 0, 29, 0, 24, 0, 24, 0, 29, 29, 0, 29, 0, 29, 0, 24, 0, 24, 0, 24, 0, 384, 0, 384, 0, 384, 0, 48, 0, 48, 0, 384, 384, 0, 384, 0, 384, 0, 336, 0, 336, 0, 384, 384, 0, 384, 0, 384, 384, 0, 24, 0, 24, 0, 24, 0, 384, 0, 384, 0, 336, 0, 336, 0, 384, 384, 0, 384, 0, 384, 384, 0, 24, 0, 24, 0, 0, 24, 0, 24, 0, 384, 0, 384, 0, 384, 0, 384, 0, 747, 0, 747, 0, 747, 0, 338, 0, 338, 0, 338, 0, 338, 0, 747, 747, 0, 747, 0, 747, 0, 409, 0, 409, 0, 747, 747, 0, 747, 0, 753, 753, 0, 384, 0, 384, 0, 71, 0, 71, 0, 384, 384, 0, 384, 0, 384, 0, 384, 384, 0, 24, 0, 24, 0, 24, 0, 24, 0, 29, 29, 0, 29, 0, 29, 0, 24, 0, 24, 0, 29, 29, 0, 29, 0, 29, 0, 0, 5, 0, 5, 0, 5, 0, 80, 0, 80, 0, 10, 0, 10, 0, 80, 80, 0, 80, 0, 80, 80, 0, 5, 0, 5, 0, 80, 0, 80, 0, 80, 0, 80, 0, 24, 0, 24, 0, 24, 0, 6, 0, 6, 0, 6, 0, 6, 0, 24, 24, 0, 24, 0, 24, 0, 18, 0, 18, 0, 24, 24, 0, 24, 0, 87, 87, 0, 80, 0, 80, 0, 12, 0, 12, 0, 80, 80, 0, 80, 0, 80, 0, 80, 80, 0, 5, 0, 5, 0, 5, 0, 25, 0, 25, 0, 50, 0, 50, 0, 55, 55, 0, 25, 0, 25, 25, 0, 5, 0, 5, 0, 5, 0, 5, 0, 0, 5, 0, 5, 0, 25, 0, 25, 0, 5, 0, 5, 0, 25, 25, 0, 25, 0, 25, 0, 20, 0, 20, 0, 20, 0, 0, 0, 0, 0, 20, 20, 0, 20, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 20, 0, 25, 25, 0, 25, 0, 25, 0, 0, 0, 0, 0, 25, 25, 0, 25, 0, 25, 0, 25, 0, 25, 0, 25, 0, 5, 0, 5, 0, 25, 25, 0, 25, 0, 25, 0, 5, 0, 5, 0, 5, 0, 0, 5, 0, 5, 0, 5, 0, 0, 5, 0, 5, 0, 25, 25, 0, 25, 25, 0, 25, 0, 25, 0, 5, 0, 5, 0, 0, 5, 0, 25, 25, 0, 25, 0, 25, 25, 0, 5, 0, 5, 0, 0, 5, 0, 5, 0, 5, 0, 5, 0, 25, 0, 25, 0, 50, 0, 50, 0, 55, 55, 0, 25, 0, 25, 25, 0, 5, 0, 5, 0, 5, 0, 5, 0, 0, 29, 29, 0, 0, 29, 0, 29, 29, 0, 0, 0, 0 };
            var maxheat = heat.Max();
            foreach (var instr in recurse(optimized))
            {
                instr.Heat = heat[instr.CompiledPos] / (double) maxheat;
            }
            foreach (var instr in optimized)
                ConsoleUtil.Write(instr.ToColoredString());
            Console.WriteLine();
#endif

            unsafe
            {
                fixed (sbyte* prg = compiled.ToArray())
                {
                    Console.WriteLine($"Prepare: {Ut.Toc():0.0}s");
                    Ut.Tic();
                    Execute(prg, Console.OpenStandardInput(), Console.OpenStandardOutput(), compiled.Count);
                    Console.WriteLine($"Execute: {Ut.Toc():0.0}s");
                }
            }

            var code = p;
            code = Regex.Replace(code, @"[><]*\[\-\]", "o");

            code = Regex.Replace(code, "[+-]+", "A");
            code = Regex.Replace(code, "[><]+", "M");

            code = code.Replace("AM", "x").Replace("A", "x").Replace("M", "x");
            code = code.Replace("[x]", "A");
            code = code.Replace("[xx]", "B");
            code = code.Replace("[xxx]", "C");
            code = code.Replace("[xxxx]", "D");
            getcounts(code);
            getloops(code);
            code = Regex.Replace(code, @"x?\[x?Ax?\]x?", "E");
            code = Regex.Replace(code, @"x?\[x?Bx?\]x?", "F");
        }

        private static List<sbyte> compile(List<Instr> prog)
        {
            var result = new List<sbyte>();
            void addUshort(int val)
            {
                ushort v = checked((ushort) val);
                result.Add((sbyte) (v & 0xFF));
                result.Add((sbyte) (v >> 8));
            }
            foreach (var instr in prog)
            {
                instr.CompiledPos = result.Count;
                if (instr is AddMoveInstr am)
                {
                    if (am.Add < sbyte.MinValue || am.Add >= i_first)
                        throw new NotImplementedException();
                    result.Add((sbyte) am.Add);
                    result.Add(checked((sbyte) am.Move));
                }
                else if (instr is AddMoveLoopedInstr am2)
                {
                    result.Add(i_addMoveLooped);
                    result.Add(checked((sbyte) am2.Add));
                    result.Add(checked((sbyte) am2.Move));
                }
                else if (instr is MoveZeroInstr mz)
                {
                    result.Add(i_moveZero);
                    result.Add(checked((sbyte) mz.Move));
                }
                else if (instr is SumInstr sm)
                {
                    result.Add(i_sum);
                    result.Add(checked((sbyte) sm.Dist));
                }
                else if (instr is LoopInstr lp)
                {
                    var body = compile(lp.Instrs);
                    if (body.Count < 255)
                    {
                        result.Add(i_fwdJumpShort);
                        result.Add((sbyte) checked((byte) body.Count));
                        foreach (var sub in recurse(lp.Instrs))
                            sub.CompiledPos += result.Count;
                        result.AddRange(body);
                        result.Add(i_bckJumpShort);
                        result.Add((sbyte) checked((byte) (body.Count + 1)));
                    }
                    else
                    {
                        result.Add(i_fwdJumpLong);
                        addUshort(body.Count);
                        foreach (var sub in recurse(lp.Instrs))
                            sub.CompiledPos += result.Count;
                        result.AddRange(body);
                        result.Add(i_bckJumpLong);
                        addUshort(body.Count + 2);
                    }
                }
                else if (instr is OutputInstr)
                    result.Add(i_output);
                else if (instr is InputInstr)
                    result.Add(i_input);
                else
                    throw new Exception();
            }
            result.Add(i_nop); // ugh... this was added for debugging and it fixed mandelbrot. Optimize it away!
            return result;
        }

        private static IEnumerable<Instr> recurse(List<Instr> instrs)
        {
            foreach (var instr in instrs)
            {
                yield return instr;
                if (instr is LoopInstr lp)
                    foreach (var i in recurse(lp.Instrs))
                        yield return i;
            }
        }

        static int pos;

        private static IEnumerable<Instr> parse(string p)
        {
            while (pos < p.Length)
            {
                if (p[pos] == '>' || p[pos] == '<')
                {
                    int moves = 0;
                    while (pos < p.Length && (p[pos] == '>' || p[pos] == '<'))
                    {
                        moves += p[pos] == '>' ? 1 : -1;
                        pos++;
                    }
                    yield return new AddMoveInstr { Move = moves };
                }
                else if (p[pos] == '+' || p[pos] == '-')
                {
                    int adds = 0;
                    while (pos < p.Length && (p[pos] == '+' || p[pos] == '-'))
                    {
                        adds += p[pos] == '+' ? 1 : -1;
                        pos++;
                    }
                    yield return new AddMoveInstr { Add = adds };
                }
                else if (p[pos] == '.')
                {
                    pos++;
                    yield return new OutputInstr();
                }
                else if (p[pos] == ',')
                {
                    pos++;
                    yield return new InputInstr();
                }
                else if (p[pos] == '[')
                {
                    pos++;
                    var loop = new LoopInstr { Instrs = parse(p).ToList() };
                    if (p[pos] != ']')
                        throw new Exception();
                    pos++;
                    yield return loop;
                }
                else if (p[pos] == ']')
                    yield break;
                else
                    throw new Exception();
            }
        }

        private static List<Instr> mergeNeighbours<T1, T2>(List<Instr> input, Func<T1, T2, bool> canMerge, Func<T1, T2, Instr> doMerge) where T1 : Instr where T2 : Instr
        {
            var result = new List<Instr>();
            var last = input[0];
            for (int i = 1; i < input.Count; i++)
            {
                if (last is T1 v1 && input[i] is T2 v2 && canMerge(v1, v2))
                {
                    result.Add(doMerge(v1, v2));
                    last = null;
                    i++;
                }
                if (last != null)
                    result.Add(last);
                if (i < input.Count)
                    last = input[i];
            }
            if (last != null)
                result.Add(last);
            return result;
        }

        private static List<Instr> optimize(List<Instr> input)
        {
            var result = new List<Instr>();
            // Merge add-moves
            result = mergeNeighbours<AddMoveInstr, AddMoveInstr>(input, (am1, am2) => am1.Move == 0 && am2.Add == 0, (am1, am2) => new AddMoveInstr { Add = am1.Add, Move = am2.Move });
            // Optimize loop bodies
            for (int i = 0; i < result.Count; i++)
            {
                if (result[i] is LoopInstr lp)
                {
                    if (lp.Instrs.Count == 1 && lp.Instrs[0] is AddMoveInstr am && am.Add == -1 && am.Move == 0)
                        result[i] = new MoveZeroInstr { Move = 0 };
                    else if (lp.Instrs.Count == 1 && lp.Instrs[0] is AddMoveInstr am2)
                        result[i] = new AddMoveLoopedInstr { Add = am2.Add, Move = am2.Move };
                    else
                        lp.Instrs = optimize(lp.Instrs);

                    if (lp.Instrs.Count == 2 && lp.Instrs[0] is AddMoveInstr add1 && lp.Instrs[1] is AddMoveInstr add2 && add1.Add == -1 && add2.Add == 1 && add1.Move == -add2.Move)
                        result[i] = new SumInstr { Dist = add1.Move };
                }
            }
            // Merge move-zeroes
            result = mergeNeighbours<AddMoveInstr, MoveZeroInstr>(result, (am, mz) => am.Add == 0, (am, mz) => new MoveZeroInstr { Move = am.Move + mz.Move });

            return result;
        }

        private abstract class Instr
        {
            public int CompiledPos; public double Heat;
            protected ConsoleColor HeatColor => Heat == 0 ? ConsoleColor.Gray : Heat < 0.1 ? ConsoleColor.White : Heat < 0.5 ? ConsoleColor.Cyan : ConsoleColor.Magenta;
            public virtual ConsoleColoredString ToColoredString() => ToString().Color(HeatColor);
        }
        private class InputInstr : Instr
        {
            public override string ToString() => ",";
        }
        private class OutputInstr : Instr
        {
            public override string ToString() => ".";
        }
        private class AddMoveInstr : Instr
        {
            public int Add, Move;
            public override string ToString() => (Add > 0 ? new string('+', Add) : new string('-', -Add)) + (Move > 0 ? new string('>', Move) : new string('<', -Move));
            public override ConsoleColoredString ToColoredString() => $"A{Add}M{Move}".Color(HeatColor);
        }
        private class AddMoveLoopedInstr : Instr
        {
            public int Add, Move;
            public override string ToString() => "[" + (Add > 0 ? new string('+', Add) : new string('-', -Add)) + (Move > 0 ? new string('>', Move) : new string('<', -Move)) + "]";
            public override ConsoleColoredString ToColoredString() => $"[LpA{Add}/M{Move}]".Color(HeatColor);
        }
        private class SumInstr : Instr
        {
            public int Dist;
            public override string ToString() => "[-" + (Dist > 0 ? new string('>', Dist) : new string('<', -Dist)) + "+" + (Dist > 0 ? new string('<', Dist) : new string('>', -Dist)) + "]";
            public override ConsoleColoredString ToColoredString() => $"[Sum{Dist}]".Color(HeatColor);
        }
        private class LoopInstr : Instr
        {
            public List<Instr> Instrs = new List<Instr>();
            public override string ToString() => "[" + string.Join("", Instrs.Select(s => s.ToString())) + "]";
            public override ConsoleColoredString ToColoredString() => "[".Color(HeatColor) + Instrs.Select(i => i.ToColoredString()).JoinColoredString() + "]".Color(HeatColor);
        }
        private class MoveZeroInstr : Instr
        {
            public int Move;
            public override string ToString() => (Move > 0 ? new string('>', Move) : new string('<', -Move)) + "[-]";
        }

        private static void getloops(string pp)
        {
            var loops1 = Regex.Matches(pp, @"\[[^[\]]+\]").Cast<Match>().Select(m => m.Value).ToLookup(x => x).Select(g => new { g.Key, Count = g.Count() }).OrderByDescending(x => x.Count).ToList();
            var loops2 = Regex.Matches(pp, @"\[[^[\]]+\]\w").Cast<Match>().Select(m => m.Value).ToLookup(x => x).Select(g => new { g.Key, Count = g.Count() }).OrderByDescending(x => x.Count).ToList();
            var loops3 = Regex.Matches(pp, @"\w\[[^[\]]+\]").Cast<Match>().Select(m => m.Value).ToLookup(x => x).Select(g => new { g.Key, Count = g.Count() }).OrderByDescending(x => x.Count).ToList();
            var loops4 = Regex.Matches(pp, @"x?\[[^[\]]+\]x?").Cast<Match>().Select(m => m.Value.Replace("x", "")).ToLookup(x => x).Select(g => new { g.Key, Count = g.Count() }).OrderByDescending(x => x.Count).ToList();
        }

        private static void getcounts(string pp)
        {
            // most common double-letter -> new letter
            // [letter] -> new letter
            var counts = new Dictionary<string, int>();
            for (int i = 0; i < pp.Length; i++)
            {
                //var m1 = new Regex(@"\w\w").Match(pp, i);
                //if (m1.Success)
                //    counts.IncSafe(m1.Value);
                //var m2 = new Regex(@"\[\w\]").Match(pp, i);
                //if (m2.Success)
                //    counts.IncSafe(m2.Value);
                var s2 = pp.SubstringSafe(i, 2);
                if (s2.Length == 2 && char.IsLetter(s2[0]) && char.IsLetter(s2[1]))
                    counts.IncSafe(s2);
                var s3 = pp.SubstringSafe(i, 3);
                if (s3.Length == 3 && s3[0] == '[' && char.IsLetter(s3[1]) && s3[2] == ']')
                    counts.IncSafe(s3);
                var s4 = pp.SubstringSafe(i, 4);
                if (s4.Length == 4 && s4[0] == '[' && char.IsLetter(s4[1]) && char.IsLetter(s4[2]) && s4[3] == ']')
                    counts.IncSafe(s4);
            }
            var cc = counts.OrderByDescending(kvp => kvp.Value).ToList();
        }

        private static uint[] heatmap = new uint[10000];

        private const sbyte i_first = 100;
        private const sbyte i_fwdJumpShort = 101;
        private const sbyte i_fwdJumpLong = 102;
        private const sbyte i_bckJumpShort = 103;
        private const sbyte i_bckJumpLong = 104;
        private const sbyte i_output = 105;
        private const sbyte i_input = 106;
        private const sbyte i_moveZero = 107;
        private const sbyte i_addMoveLooped = 108;
        private const sbyte i_sum = 109;
        private const sbyte i_nop = 111;
        private const sbyte i_end = 122;

        private unsafe static void Execute(sbyte* program, Stream input, Stream output, int progLen)
        {
            var tapeLen = 30_000;
            sbyte* tape = stackalloc sbyte[tapeLen];
            var tapeStart = tape;
            var tapeEnd = tape + tapeLen; // todo: wrap around
            tape += tapeLen / 2;
#if DEBUG
            var progStart = program;
            var progEnd = program + progLen;
#endif
            var outpt = new List<byte>();
            void flushOutput()
            {
                Console.WriteLine($"Hm?! {Ut.Toc()}");
                output.Write(outpt.ToArray());
                Console.WriteLine();
                Console.WriteLine($"Hm?!?! {Ut.Toc()}");
                outpt.Clear();
            }

            while (true)
            {
#if DEBUG
                if (tape < tapeStart || tape >= tapeEnd) throw new Exception();
                if (program < progStart || program >= progEnd) throw new Exception();
                checked { heatmap[program - progStart]++; }
                // heatmap.Take(progLen).JoinString(",")
#endif

                sbyte a = *(program++);
                if (a < i_first)
                {
                    *tape += a; // add
                    tape += *(program++); // move
                    continue;
                }
                // less common cases
                if (a == i_fwdJumpShort)
                {
                    if (*tape == 0)
                        program += *(byte*) program;
                    else
                        program++; // optimize: add unconditionally
                }
                else if (a == i_bckJumpShort)
                {
                    if (*tape != 0)
                        program -= *(byte*) program;
                    else
                        program++; // optimize: add unconditionally
                }
                else if (a == i_moveZero)
                {
                    tape += *(program++); // move
                    *tape = 0;
                }
                else if (a == i_addMoveLooped)
                {
                    sbyte add = *(program++);
                    sbyte move = *(program++);
                    while (*tape != 0)
                    {
                        *tape += add;
                        tape += move;
                    }
                }
                else if (a == i_sum)
                {
                    sbyte dist = *(program++);
                    sbyte val = *tape;
                    *(tape + dist) += val;
                    *tape = 0;
                }
                else if (a == i_output)
                {
#if DEBUG
                    output.WriteByte(*(byte*) tape);
#else
                    outpt.Add(*(byte*) tape);
#endif
                }
                else if (a == i_input)
                {
                    flushOutput();
                    throw new NotImplementedException();
                }

                // least common cases
                else if (a == i_fwdJumpLong)
                {
                    if (*tape == 0)
                    {
                        int dist = *(byte*) (program++);
                        dist |= (*(byte*) program) << 8;
                        program += dist;
                    }
                    else
                        program += 2; // optimize: add unconditionally
                }
                else if (a == i_bckJumpLong)
                {
                    if (*tape != 0)
                    {
                        int dist = *(byte*) (program++);
                        dist |= (*(byte*) program) << 8;
                        program -= dist;
                    }
                    else
                        program += 2; // optimize: add unconditionally
                }
                else if (a == i_nop)
                { }
                else if (a == i_end)
                {
                    flushOutput();
                    return;
                }

                else
                    throw new Exception();
            }
        }
    }
}
